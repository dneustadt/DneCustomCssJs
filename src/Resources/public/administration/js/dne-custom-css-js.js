(function(){var e={724:function(){},492:function(){Shopware.Service("privileges").addPrivilegeMappingEntry({category:"permissions",parent:null,key:"dne_custom_js_css",roles:{viewer:{privileges:["dne_custom_js_css:read"],dependencies:[]},editor:{privileges:["dne_custom_js_css:update","dne_custom_js_css_sales_channel:create","dne_custom_js_css_sales_channel:delete"],dependencies:[]},creator:{privileges:["dne_custom_js_css:create","dne_custom_js_css_sales_channel:create","dne_custom_js_css_sales_channel:delete"],dependencies:[]},deleter:{privileges:["dne_custom_js_css:delete"],dependencies:[]}}})},231:function(e,s,t){var n=t(724);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals),t(346).Z("9a07b906",n,!0,{})},346:function(e,s,t){"use strict";function n(e,s){for(var t=[],n={},o=0;o<s.length;o++){var i=s[o],a=i[0],l={id:e+":"+o,css:i[1],media:i[2],sourceMap:i[3]};n[a]?n[a].parts.push(l):t.push(n[a]={id:a,parts:[l]})}return t}t.d(s,{Z:function(){return h}});var o="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!o)throw Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},a=o&&(document.head||document.getElementsByTagName("head")[0]),l=null,r=0,c=!1,d=function(){},u=null,m="data-vue-ssr-id",p="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function h(e,s,t,o){c=t,u=o||{};var a=n(e,s);return v(a),function(s){for(var t=[],o=0;o<a.length;o++){var l=i[a[o].id];l.refs--,t.push(l)}s?v(a=n(e,s)):a=[];for(var o=0;o<t.length;o++){var l=t[o];if(0===l.refs){for(var r=0;r<l.parts.length;r++)l.parts[r]();delete i[l.id]}}}}function v(e){for(var s=0;s<e.length;s++){var t=e[s],n=i[t.id];if(n){n.refs++;for(var o=0;o<n.parts.length;o++)n.parts[o](t.parts[o]);for(;o<t.parts.length;o++)n.parts.push(g(t.parts[o]));n.parts.length>t.parts.length&&(n.parts.length=t.parts.length)}else{for(var a=[],o=0;o<t.parts.length;o++)a.push(g(t.parts[o]));i[t.id]={id:t.id,refs:1,parts:a}}}}function f(){var e=document.createElement("style");return e.type="text/css",a.appendChild(e),e}function g(e){var s,t,n=document.querySelector("style["+m+'~="'+e.id+'"]');if(n){if(c)return d;n.parentNode.removeChild(n)}if(p){var o=r++;s=C.bind(null,n=l||(l=f()),o,!1),t=C.bind(null,n,o,!0)}else s=w.bind(null,n=f()),t=function(){n.parentNode.removeChild(n)};return s(e),function(n){n?(n.css!==e.css||n.media!==e.media||n.sourceMap!==e.sourceMap)&&s(e=n):t()}}var _=function(){var e=[];return function(s,t){return e[s]=t,e.filter(Boolean).join("\n")}}();function C(e,s,t,n){var o=t?"":n.css;if(e.styleSheet)e.styleSheet.cssText=_(s,o);else{var i=document.createTextNode(o),a=e.childNodes;a[s]&&e.removeChild(a[s]),a.length?e.insertBefore(i,a[s]):e.appendChild(i)}}function w(e,s){var t=s.css,n=s.media,o=s.sourceMap;if(n&&e.setAttribute("media",n),u.ssrId&&e.setAttribute(m,s.id),o&&(t+="\n/*# sourceURL="+o.sources[0]+" */\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},s={};function t(n){var o=s[n];if(void 0!==o)return o.exports;var i=s[n]={id:n,exports:{}};return e[n](i,i.exports,t),i.exports}t.d=function(e,s){for(var n in s)t.o(s,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:s[n]})},t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},t.p="bundles/dnecustomcssjs/",window?.__sw__?.assetPath&&(t.p=window.__sw__.assetPath+"/bundles/dnecustomcssjs/"),function(){"use strict";let{Component:e}=Shopware,{Criteria:s}=Shopware.Data;e.register("dne-module-list",{template:'{% block dne_module_list %}\n    <sw-page class="dne-module-list">\n        {% block dne_module_list_smart_bar_actions %}\n            <template #smart-bar-actions>\n                <sw-button\n                    variant="primary"\n                    :routerLink="{ name: \'dne.module.create\' }"\n                    :disabled="!acl.can(\'dne_custom_js_css.creator\')"\n                >\n                    {{ $t(\'dne-customcssjs.modules.addModulesButton\') }}\n                </sw-button>\n            </template>\n        {% endblock %}\n\n        <template #content>\n            {% block dne_module_list_content %}\n                <sw-entity-listing\n                        v-if="modules"\n                        ref="listing"\n                        :items="modules"\n                        :repository="repository"\n                        :showSelection="false"\n                        :columns="columns"\n                        detailRoute="dne.module.detail">\n                    <template #column-active="{ item }">\n                        <sw-data-grid-column-boolean\n                            :value="item.active"\n                            :isInlineEdit="false">\n                        </sw-data-grid-column-boolean>\n                    </template>\n                    <template #column-salesChannels="{ item }">\n                        <div v-if="item.salesChannels.length">\n                            <sw-label\n                                v-for="salesChannel in item.salesChannels"\n                                :key="salesChannel.id">\n                                {{ salesChannel.name }}\n                            </sw-label>\n                        </div>\n                        <span v-else>\n                            {{ $t(\'dne-customcssjs.modules.salesChannelsAll\') }}\n                        </span>\n                    </template>\n                </sw-entity-listing>\n                <div v-if="isLoading"\n                     class="sw-overlay">\n                    <sw-loader></sw-loader>\n                </div>\n            {% endblock %}\n        </template>\n    </sw-page>\n{% endblock %}\n',inject:["repositoryFactory","context","acl","themeService"],data(){return{repository:null,modules:null,isLoading:!0}},metaInfo(){return{title:this.$createTitle()}},computed:{columns(){return[{property:"active",label:this.$t("dne-customcssjs.modules.activeLabel"),allowResize:!1,align:"center",width:"125px"},{property:"name",dataIndex:"name",label:this.$t("dne-customcssjs.modules.nameLabel"),routerLink:"dne.module.detail",allowResize:!0,primary:!0},{property:"salesChannels",dataIndex:"salesChannels",label:this.$t("dne-customcssjs.modules.salesChannelsLabel"),allowResize:!0,sortable:!1}]},salesChannelRepository(){return this.repositoryFactory.create("sales_channel")}},created(){this.repository=this.repositoryFactory.create("dne_custom_js_css");let e=new s;e.addAssociation("salesChannels"),e.addSorting(s.sort("name","ASC",!1)),this.repository.search(e,Shopware.Context.api).then(e=>{this.modules=e,this.isLoading=!1,this.$nextTick().then(()=>{this.$refs.listing.$on("delete-item-finish",()=>{this.isLoading=!0,this.compileTheme().then(()=>{this.isLoading=!1}).catch(()=>{this.isLoading=!1})})})})},methods:{async compileTheme(){let e=new s;for(let s of(e.addAssociation("themes"),await this.salesChannelRepository.search(e,Shopware.Context.api))){let e=s.extensions.themes.first();e&&await this.themeService.assignTheme(e.id,s.id)}}}}),t(231);let{Component:n,Mixin:o,Filter:i}=Shopware,{mapPropertyErrors:a}=Shopware.Component.getComponentHelper(),{Criteria:l}=Shopware.Data;n.register("dne-module-detail",{template:'{% block dne_module_detail %}\n    <sw-page class="dne-module-detail">\n        <template #smart-bar-actions>\n            <sw-button :routerLink="{ name: \'dne.module.list\' }">\n                {{ $t(\'dne-customcssjs.modules.cancelButton\') }}\n            </sw-button>\n\n            <sw-button-process\n                    v-if="module"\n                    :isLoading="isLoading"\n                    :processSuccess="processSuccess"\n                    :disabled="module.isNew() ? !acl.can(\'dne_custom_js_css.creator\') : !acl.can(\'dne_custom_js_css.editor\')"\n                    variant="primary"\n                    @process-finish="saveFinish"\n                    @click="onClickSave">\n                {{ $t(\'dne-customcssjs.modules.saveButton\') }}\n            </sw-button-process>\n\n            <sw-button-process\n                    v-if="module"\n                    :isLoading="isLoading"\n                    :processSuccess="processSuccess"\n                    :disabled="module.isNew() ? !acl.can(\'dne_custom_js_css.creator\') : !acl.can(\'dne_custom_js_css.editor\')"\n                    variant="primary"\n                    @update:process-success="saveFinish"\n                    @click="onClickSaveCompile">\n                {{ $t(\'dne-customcssjs.modules.saveCompileButton\') }}\n            </sw-button-process>\n        </template>\n\n        <template #content>\n            <sw-card-view>\n                <sw-card v-if="module" :isLoading="isLoading">\n                    <sw-checkbox-field\n                        :label="$t(\'dne-customcssjs.modules.activeLabel\')"\n                        v-model:value="module.active">\n                    </sw-checkbox-field>\n\n                    <sw-container columns="1fr 1fr" gap="16px">\n                        <sw-text-field\n                                  :label="$t(\'dne-customcssjs.modules.nameLabel\')"\n                                  v-model:value="module.name"\n                                  validation="required"\n                                  :error="moduleNameError"\n                                  required>\n                        </sw-text-field>\n\n                        <sw-entity-many-to-many-select\n                            :localMode="module.isNew()"\n                            :label="$t(\'dne-customcssjs.modules.salesChannelsLabel\')"\n                            :placeholder="$t(\'dne-customcssjs.modules.salesChannelsAll\')"\n                            v-model:entityCollection="module.salesChannels">\n                        </sw-entity-many-to-many-select>\n                    </sw-container>\n\n                    <sw-compact-colorpicker\n                              compact\n                              :alpha="false"\n                              @update:value="pickColor">\n                    </sw-compact-colorpicker>\n\n                    <sw-code-editor\n                        :label="$t(\'dne-customcssjs.modules.cssLabel\')"\n                        ref="cssEditor"\n                        name="css"\n                        identifier="value"\n                        completionMode="entity"\n                        :editorConfig="editorConfigSass"\n                        v-model:value="module.css">\n                    </sw-code-editor>\n\n                    <sw-code-editor\n                        :label="$t(\'dne-customcssjs.modules.jsLabel\')"\n                        name="js"\n                        identifier="value"\n                        completionMode="entity"\n                        :editorConfig="editorConfigJs"\n                        v-model:value="module.js">\n                    </sw-code-editor>\n                </sw-card>\n            </sw-card-view>\n        </template>\n    </sw-page>\n{% endblock %}\n',inject:["repositoryFactory","context","acl","themeService"],mixins:[o.getByName("notification")],metaInfo(){return{title:this.$createTitle()}},data(){return{syncService:null,httpClient:null,module:null,isLoading:!1,processSuccess:!1,repository:null}},props:{moduleId:{type:String,required:!1,default:null}},computed:{editorConfigJs(){return{mode:"ace/mode/javascript",useWorker:!1}},editorConfigSass(){return{mode:"ace/mode/css"}},salesChannelRepository(){return this.repositoryFactory.create("sales_channel")},...a("module",["name"])},created(){this.repository=this.repositoryFactory.create("dne_custom_js_css"),this.getModule(),this.syncService=Shopware.Service("syncService"),this.httpClient=this.syncService.httpClient},methods:{getModule(){this.moduleId||this.module?.id?this.repository.get(this.moduleId||this.module?.id,Shopware.Context.api).then(e=>{this.module=e}):this.module=this.repository.create(Shopware.Context.api)},onClickSave(){return this.isLoading=!0,this.repository.save(this.module,Shopware.Context.api).then(()=>{this.moduleId||this.$router.push({name:"dne.module.detail",params:{id:this.module.id}}),this.getModule(),this.isLoading=!1,this.processSuccess=!0}).catch(e=>{this.isLoading=!1,this.module.name&&this.module.name.length&&this.createNotificationError({title:"Error",message:e})})},onClickSaveCompile(){this.onClickSave().then(()=>{this.isLoading=!0,this.compileTheme().then(()=>{this.isLoading=!1}).catch(e=>{this.isLoading=!1;try{this.createNotificationError({title:e.response.data.errors[0].title,message:i.getByName("truncate")(e.response.data.errors[0].detail,300),autoClose:!1})}catch(s){this.createNotificationError({title:e.title,message:e.message,autoClose:!1})}})})},saveFinish(){this.processSuccess=!1},pickColor(e){if(!this.$refs.cssEditor)return;let s=this.$refs.cssEditor.editor;s&&(s.session.insert(s.getCursorPosition(),e),s.renderer.scrollCursorIntoView(s.getCursorPosition(),.5))},async compileTheme(){let e=new l;for(let s of(e.addAssociation("themes"),await this.salesChannelRepository.search(e,Shopware.Context.api))){let e=s.extensions.themes.first();e&&await this.themeService.assignTheme(e.id,s.id)}}}}),t(492);var r=JSON.parse('{"dne-customcssjs":{"modules":{"menu":"Custom CSS/JS","title":"CSS/JS Container","addModulesButton":"Container hinzuf\xfcgen","salesChannelsLabel":"Verkaufskan\xe4le","salesChannelsAll":"alle","nameLabel":"Name","cssLabel":"CSS/SCSS","jsLabel":"JavaScript","activeLabel":"Aktiv","saveButton":"Speichern","saveCompileButton":"Speichern & Kompilieren","cancelButton":"Abbrechen"}},"sw-privileges":{"permissions":{"dne_custom_js_css":{"label":"Custom CSS/JS"}}}}'),c=JSON.parse('{"dne-customcssjs":{"modules":{"menu":"Custom CSS/JS","title":"CSS/JS Container","addModulesButton":"Add Container","salesChannelsLabel":"Sales channels","salesChannelsAll":"all","nameLabel":"Name","cssLabel":"CSS/SCSS","jsLabel":"JavaScript","activeLabel":"Active","saveButton":"Save","saveCompileButton":"Save & Compile","cancelButton":"Cancel"}},"sw-privileges":{"permissions":{"dne_custom_js_css":{"label":"Custom CSS/JS"}}}}');let{Module:d}=Shopware;d.register("dne-module",{color:"#ff3d58",icon:"regular-code",title:"dne-customcssjs.modules.title",description:"",snippets:{"de-DE":r,"en-GB":c},routes:{list:{component:"dne-module-list",path:"list",meta:{privilege:"dne_custom_js_css.viewer"}},detail:{component:"dne-module-detail",path:"detail/:id",meta:{parentPath:"dne.module.list",privilege:"dne_custom_js_css.viewer"},props:{default(e){return{moduleId:e.params.id}}}},create:{component:"dne-module-detail",path:"create",meta:{parentPath:"dne.module.list",privilege:"dne_custom_js_css.creator"}}},navigation:[{label:"dne-customcssjs.modules.menu",path:"dne.module.list",parent:"sw-extension",position:100}]})}()})();
//# sourceMappingURL=dne-custom-css-js.js.map